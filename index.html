<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <meta name="description" content="Skinly - AI-powered skin disease detection">
        <meta name="author" content="Your Team Name">

        <title>Skinly - Skin Disease Detection</title>

        <!-- CSS FILES -->        
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">

        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/bootstrap-icons.css" rel="stylesheet">
        <link href="css/owl.carousel.min.css" rel="stylesheet">
        <link href="css/owl.theme.default.min.css" rel="stylesheet">
        <link href="css/templatemo-medic-care.css" rel="stylesheet">

        <!-- Custom CSS for Chat and Results -->
        <style>
            #chatWindow {
                border: 1px solid #ddd;
                padding: 10px;
                background-color: #f9f9f9;
                height: 300px;
                overflow-y: auto;
                margin-bottom: 15px;
                border-radius: 5px;
            }

            #analysisResult {
                font-size: 1.1em;
                color: #333;
                margin-top: 15px;
            }

            .chat-message {
                margin-bottom: 10px;
            }

            .chat-message.user {
                text-align: right;
            }

            .chat-message.ai {
                text-align: left;
            }
        </style>
    </head>
    
    <body id="top">
        <main>
            <nav class="navbar navbar-expand-lg bg-light fixed-top shadow-lg">
                <div class="container">
                    <a class="navbar-brand mx-auto d-lg-none" href="index.html">
                        Skinly
                        <strong class="d-block">AI Skin Detection</strong>
                    </a>

                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav mx-auto">
                            <li class="nav-item active">
                                <a class="nav-link" href="#hero">Home</a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link" href="#about">About</a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link" href="#how-it-works">How It Works</a>
                            </li>

                            <a class="navbar-brand d-none d-lg-block" href="index.html">
                                Skinly
                                <strong class="d-block">AI Skin Detection</strong>
                            </a>

                            <li class="nav-item">
                                <a class="nav-link" href="#upload">Upload</a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link" href="#contact">Contact</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

            <!-- Hero Section -->
            <section class="hero" id="hero">
                <div class="container">
                    <div class="row">
                        <div class="col-12">
                            <div id="myCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel">
                                <div class="carousel-inner">
                                    <div class="carousel-item active">
                                        <img src="images/slider/black-female-doctor-doing-her-job.jpg" class="img-fluid" alt="Skin Care">
                                    </div>

                                    <div class="carousel-item">
                                        <img src="images/slider/medium-shot-smiley-woman-seaside.jpg" class="img-fluid" alt="Skin Care">
                                    </div>

                                    <div class="carousel-item">
                                        <img src="images/slider/front-view-adult-man-grooming_23-2148272574.jpg" class="img-fluid" alt="Skin Care">
                                    </div>
                                </div>
                            </div>

                            <div class="heroText d-flex flex-column justify-content-center">
                                <h1 class="mt-auto mb-2">
                                    Detect Skin Diseases
                                    <div class="animated-info">
                                        <span class="animated-item">Fast</span>
                                        <span class="animated-item">Accurate</span>
                                        <span class="animated-item">Free</span>
                                    </div>
                                </h1>

                                <p class="mb-4">Skinly is an AI-powered tool that helps you detect skin diseases from the comfort of your home. Upload your skin image and get instant results.</p>

                                <div class="heroLinks d-flex flex-wrap align-items-center">
                                    <a class="custom-link me-4" href="#upload" data-hover="Get Started">Get Started</a>
                                    <p class="contact-phone mb-0"><i class="bi-phone"></i> App Store</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- About Section -->
            <section class="section-padding" id="about">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-6 col-md-6 col-12">
                            <h2 class="mb-lg-3 mb-3">About Skinly</h2>
                            <p>Welcome to Skinly, your trusted companion for early skin disease detection and awareness. Our mission is to empower individuals with the tools to take control of their skin health by providing fast, accurate, and accessible skin disease screening.</p>
                            <p>Using advanced AI technology, Skinly analyzes your skin images and provides instant insights. Learn about skin health and diseases through AI-generated, user-friendly explanations. Your data is safe with usâ€”we prioritize your privacy and security.</p>
                        </div>
                        <div class="col-lg-4 col-md-5 col-12 mx-auto">
                            <div class="featured-circle bg-white shadow-lg d-flex justify-content-center align-items-center">
                                <p class="featured-text"><span class="featured-number">Skinly</span> Fast, Free<br> and Accurate</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- How It Works Section -->
            <section class="section-padding" id="how-it-works">
                <div class="container">
                    <div class="row">
                        <h2 class="text-center mb-lg-5 mb-4">How It Works</h2>
                        <div class="col-lg-4 col-md-6 col-12">
                            <div class="how-it-works-card text-center p-4 shadow-lg rounded">
                                <i class="bi-upload display-6 mb-3"></i>
                                <h3>Upload Image</h3>
                                <p>Upload a clear image of the affected skin area.</p>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6 col-12">
                            <div class="how-it-works-card text-center p-4 shadow-lg rounded">
                                <i class="bi-gear display-6 mb-3"></i>
                                <h3>AI Analysis</h3>
                                <p>Our AI analyzes the image and compares it with thousands of skin disease patterns.</p>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6 col-12">
                            <div class="how-it-works-card text-center p-4 shadow-lg rounded">
                                <i class="bi-file-earmark-text display-6 mb-3"></i>
                                <h3>Get Results</h3>
                                <p>Receive instant results and detailed explanations about the detected condition.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Upload Section -->
            <section class="section-padding" id="upload">
                <div class="container">
                    <div class="row">
                        <h2 class="text-center mb-lg-5 mb-4">Upload Your Skin Image</h2>
                        <div class="col-lg-6 col-12 mx-auto">
                            <div class="upload-form text-center p-4 shadow-lg rounded">
                                <form id="uploadForm" enctype="multipart/form-data">
                                    <input type="file" id="skinImage" name="skinImage" accept="image/*" class="form-control mb-3" required>
                                    <button type="submit" class="btn btn-primary">Analyze Image</button>
                                </form>
                                <!-- Results Display -->
                                <div id="result" class="mt-4">
                                    <h4>Analysis Results</h4>
                                    <p id="analysisResult" class="text-start"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Chat Section -->
            <section class="section-padding" id="chat">
                <div class="container">
                    <div class="row">
                        <h2 class="text-center mb-lg-5 mb-4">Chat with AI</h2>
                        <div class="col-lg-6 col-12 mx-auto">
                            <div class="chat-interface p-4 shadow-lg rounded">
                                <div id="chatWindow" class="mb-3">
                                    <!-- Chat messages will appear here -->
                                </div>
                                <form id="chatForm" class="d-flex">
                                    <input type="text" id="chatInput" class="form-control me-2" placeholder="Ask a question..." required>
                                    <button type="submit" class="btn btn-primary">Send</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Footer Section -->
            <footer class="site-footer section-padding" id="contact">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-5 me-auto col-12">
                            <h5 class="mb-lg-4 mb-3">Contact Us</h5>
                            <p><a href="mailto:hello@skinly.com">Built by:</a></p>
                            <p>Baasir <br> Luis <br> Jay <br>Elijah</p>
                        </div>

                        <div class="col-lg-3 col-md-6 col-12 ms-auto">
                            <h5 class="mb-lg-4 mb-3">Socials</h5>
                            <ul class="social-icon">
                                <li><a href="#" class="social-icon-link bi-facebook"></a></li>
                                <li><a href="#" class="social-icon-link bi-twitter"></a></li>
                                <li><a href="#" class="social-icon-link bi-instagram"></a></li>
                                <li><a href="#" class="social-icon-link bi-youtube"></a></li>
                            </ul>
                        </div>

                        <div class="col-lg-3 col-12 ms-auto mt-4 mt-lg-0">
                            <p class="copyright-text">Copyright Â© Skinly 2025</p>
                        </div>
                    </div>
                </div>
            </footer>
        </main>

        <!-- JAVASCRIPT FILES -->
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.bundle.min.js"></script>
        <script src="js/owl.carousel.min.js"></script>
        <script src="js/scrollspy.min.js"></script>
        <script src="js/custom.js"></script>

        <!-- JavaScript for Upload and Chat -->
        <script>
            let isRequestInProgress = false; // Add this line at the top

            // Handle Image Upload and Display Results
            document.getElementById('uploadForm').addEventListener('submit', async function (e) {
                e.preventDefault();
                const formData = new FormData();
                const fileInput = document.getElementById('skinImage');
                formData.append('skinImage', fileInput.files[0]);

                try {
                    const response = await fetch('/analyze', { // Replace with your backend endpoint
                        method: 'POST',
                        body: formData,
                    });
                    const data = await response.json();
                    document.getElementById('analysisResult').innerText = data.result; // Display analysis result
                } catch (error) {
                    console.error('Error:', error);
                    document.getElementById('analysisResult').innerText = 'Error analyzing image.';
                }
            });

            // Handle Chat Interaction
            document.getElementById('chatForm').addEventListener('submit', async function (e) {
                e.preventDefault();

                if (isRequestInProgress) {
                    alert('Please wait before sending another message.');
                    return;
                }

                isRequestInProgress = true;

                const chatInput = document.getElementById('chatInput');
                const chatWindow = document.getElementById('chatWindow');

                // Add user message to chat window
                chatWindow.innerHTML += `<div class="chat-message user"><strong>You:</strong> ${chatInput.value}</div>`;

                try {
                    const response = await fetch('/chat', { // Replace with your backend endpoint
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ message: chatInput.value }),
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }

                    const data = await response.json();

                    if (data.response) {
                        chatWindow.innerHTML += `<div class="chat-message ai"><strong>AI:</strong> ${data.response}</div>`;
                    } else {
                        throw new Error('No response from AI');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    chatWindow.innerHTML += `<div class="chat-message ai"><strong>AI:</strong> Error processing your message. Please try again.</div>`;
                }

                // Clear input and scroll to bottom
                chatInput.value = '';
                chatWindow.scrollTop = chatWindow.scrollHeight;

                // Add a delay before allowing another request
                setTimeout(() => {
                    isRequestInProgress = false;
                }, 20000); // 20-second delay
            });
        </script>
    </body>
</html>